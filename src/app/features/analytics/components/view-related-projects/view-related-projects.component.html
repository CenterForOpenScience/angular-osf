<osf-sub-header
  [title]="title()"
  [showButton]="isAuthenticated()"
  [buttonLabel]="'project.overview.actions.forkProjectLabel' | translate"
  (buttonClick)="handleForkResource()"
/>

<div class="flex flex-column flex-1 bg-white gap-5 p-3 sm:p-4">
  @if (!isLoading() && currentResource()) {
    @if (!items().length) {
      <p class="mt-5 text-center">{{ emptyScreenMessage() }}</p>
    } @else {
      <p>{{ message() }}</p>

      @for (relatedItem of items(); track relatedItem.id) {
        <div class="duplicate-wrapper flex flex-column gap-3 p-3 sm:p-4">
          <div class="flex justify-content-between align-items-center">
            <h2 class="flex align-items-center gap-2">
              <osf-icon [iconClass]="relatedItem.public ? 'fas fa-lock-open' : 'fas fa-lock'"></osf-icon>
              {{ relatedItem.title }}
            </h2>

            @if (showMoreOptions(relatedItem)) {
              <div>
                <p-button
                  severity="contrast"
                  icon="fas fa-ellipsis-vertical"
                  raised
                  variant="outlined"
                  [ariaLabel]="'common.buttons.more' | translate"
                  (onClick)="menu.toggle($event)"
                >
                </p-button>

                <p-menu appendTo="body" [model]="forkActionItems(relatedItem.id)" popup #menu>
                  <ng-template #item let-item>
                    <a
                      class="p-menu-item-link"
                      (mousedown)="handleMenuAction(item.action, item.resourceId)"
                      (keydown.enter)="handleMenuAction(item.action, item.resourceId)"
                      tabindex="0"
                    >
                      {{ item.label | translate }}
                    </a>
                  </ng-template>
                </p-menu>
              </div>
            }
          </div>

          <div class="flex flex-column gap-2">
            <div class="flex flex-wrap align-items-center gap-1">
              <span class="font-bold">{{ 'common.labels.forked' | translate }}:</span>
              <p>{{ relatedItem.dateCreated | date: 'MMM d, y, h:mm a' }}</p>
            </div>

            <div class="flex flex-wrap align-items-center gap-1">
              <span class="font-bold">{{ 'common.labels.lastUpdated' | translate }}:</span>
              <p>{{ relatedItem.dateModified | date: 'MMM d, y, h:mm a' }}</p>
            </div>

            <div class="flex flex-wrap align-items-center gap-1">
              <span class="font-bold">{{ 'common.labels.contributors' | translate }}:</span>

              <osf-contributors-list [contributors]="relatedItem.contributors"></osf-contributors-list>
            </div>

            @if (relatedItem.description) {
              <osf-truncated-text
                [text]="('resourceCard.labels.descriptionBold' | translate) + relatedItem.description"
              />
            }
          </div>
          @if (isShowingDuplicates()) {
            <p-button
              [label]="'common.buttons.view' | translate"
              severity="secondary"
              [routerLink]="['/', relatedItem.id]"
            />
          }
        </div>
      }

      @if (totalDuplicates() > pageSize) {
        <osf-custom-paginator
          [totalCount]="totalDuplicates()"
          [rows]="pageSize"
          [first]="firstIndex()"
          (pageChanged)="onPageChange($event)"
        />
      }
    }
  } @else {
    <osf-loading-spinner></osf-loading-spinner>
  }
</div>
