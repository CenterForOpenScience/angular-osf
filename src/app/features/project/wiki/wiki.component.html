<osf-sub-header [title]="'navigation.wiki' | translate">
  <p-buttongroup class="ml-auto">
    <p-button
      [label]="'project.wiki.view' | translate"
      [variant]="wikiModes().view ? undefined : 'outlined'"
      (onClick)="toggleMode(WikiModes.View)"
    />
    @if (hasWriteAccess()) {
      <p-button
        [label]="'project.wiki.edit' | translate"
        [variant]="wikiModes().edit ? undefined : 'outlined'"
        (onClick)="toggleMode(WikiModes.Edit)"
      />
    }
    <p-button
      [label]="'project.wiki.compare' | translate"
      [variant]="wikiModes().compare ? undefined : 'outlined'"
      (onClick)="toggleMode(WikiModes.Compare)"
    />
  </p-buttongroup>
</osf-sub-header>

@if (hasViewOnly()) {
  <div class="bg-white w-full px-5 pt-5 pb-1">
    <osf-view-only-link-message />
  </div>
}

<section class="flex flex-column lg:flex-row lg:flex-wrap bg-white flex-1 h-full p-5 gap-4 w-full wiki-page">
  <osf-wiki-list
    [list]="wikiList()"
    [resourceId]="projectId()"
    [isLoading]="isWikiListLoading()"
    [componentsList]="componentsWikiList()"
    [currentWikiId]="currentWikiId()"
    [canEdit]="hasWriteAccess()"
    (createWiki)="onCreateWiki()"
    (deleteWiki)="onDeleteWiki()"
  ></osf-wiki-list>
  @if (wikiModes().view) {
    <osf-view-section
      [versions]="wikiVersions()"
      [previewContent]="previewContent()"
      [versionContent]="versionContent()"
      [isLoading]="isWikiVersionLoading()"
      (selectVersion)="onSelectVersion($event)"
    ></osf-view-section>
  }
  @if (hasWriteAccess() && wikiModes().edit) {
    <osf-edit-section
      [currentContent]="previewContent()"
      [versionContent]="versionContent()"
      (contentChange)="updateWikiPreviewContent($event)"
      [isSaving]="isWikiVersionSubmitting()"
      (saveContent)="onSaveContent($event)"
    ></osf-edit-section>
  }
  @if (wikiModes().compare) {
    <osf-compare-section
      [versions]="wikiVersions()"
      [previewContent]="previewContent()"
      [versionContent]="compareVersionContent()"
      [isLoading]="isWikiVersionLoading()"
      (selectVersion)="onSelectCompareVersion($event)"
    ></osf-compare-section>
  }
</section>
