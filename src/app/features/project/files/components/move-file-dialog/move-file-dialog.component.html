@if (files().isLoading || isFilesUpdating()) {
  <div class="w-8rem ml-auto mr-auto">
    <osf-loading-spinner></osf-loading-spinner>
  </div>
} @else {
  <div class="flex flex-column gap-2">
    <div class="flex gap-2">
      <img [ngSrc]="'/assets/images/cos-shield.svg'" width="24" height="24" alt="cost-shield" />
      <h2 class="font-normal">OSF Storage</h2>
    </div>

    <div class="files-table">
      @if (currentFolder()?.relationships?.parentFolderLink) {
        <div class="files-table-row">
          <div class="flex gap-2">
            <div
              tabindex="0"
              (click)="openParentFolder()"
              (keydown.enter)="openParentFolder()"
              class="parent-folder-link"
            >
              <i class="osf-icon-arrow-left"></i>
              <i class="osf-icon-folder"></i>
              {{ currentFolder()?.name ?? '' }}
            </div>
          </div>
        </div>
      }

      @for (file of files().data; track $index) {
        <div class="files-table-row" [class.pl-6]="currentFolder()?.relationships?.parentFolderLink">
          <div class="flex gap-2">
            @if (file.kind !== 'folder') {
              <i style="color: #8b97a4" class="osf-icon-doc"></i>
              <div>{{ file?.name ?? '' }}</div>
            } @else if (config.data.file.id === file.id) {
              <i style="color: #8b97a4" class="osf-icon-folder"></i>
              <div pTooltip="Cannot move to the same folder">{{ file?.name ?? '' }}</div>
            } @else {
              <i class="osf-icon-folder"></i>
              <div tabindex="0" (click)="openFolder(file)" (keydown.enter)="openFolder(file)" class="filename-link">
                {{ file?.name ?? '' }}
              </div>
            }
          </div>
        </div>
      }
      @if (!files().data.length) {
        <div class="flex justify-content-center p-4">
          <h3 class="font-normal text-no-transform">This folder is empty</h3>
        </div>
      }
    </div>
  </div>
}

<div class="flex gap-2 ml-auto">
  <p-button (click)="dialogRef.close()" [text]="true" severity="info" label="Cancel"></p-button>

  @if (this.config.data.action === 'move') {
    <p-button
      [disabled]="isFolderSame() || files().isLoading || isFilesUpdating()"
      label="Move"
      (click)="moveFile()"
    ></p-button>
  } @else if (this.config.data.action === 'copy') {
    <p-button
      [disabled]="isFolderSame() || files().isLoading || isFilesUpdating()"
      label="Copy"
      (click)="moveFile()"
    ></p-button>
  }
</div>
