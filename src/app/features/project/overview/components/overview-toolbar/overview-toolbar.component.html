@let resource = currentResource();

@if (resource) {
  <div class="flex flex-column gap-5 lg:flex-row lg:align-items-center lg:justify-content-between">
    @if (!isCollectionsRoute() && isAdmin() && !isRegistration) {
      <div class="flex gap-3 align-items-center">
        <div class="flex gap-1" [class.inactive]="isPublic()">
          <i class="fas fa-lock"></i>
          <p class="font-bold">{{ 'project.overview.header.privateProject' | translate }}</p>
        </div>

        <p-toggleswitch
          class="visibility-switch"
          [ariaLabel]="'common.accessibility.toggleProjectVisibility' | translate"
          [(ngModel)]="isPublic"
          (onChange)="handleToggleProjectPublicity()"
        />

        <div class="flex gap-2" [class.inactive]="!isPublic()">
          <i class="fas fa-lock-open"></i>
          <p class="font-bold">{{ 'project.overview.header.publicProject' | translate }}</p>
        </div>
      </div>
    }

    @if (isCollectionsRoute() || hasViewOnly() || !isAdmin()) {
      @if (isPublic()) {
        <div class="flex gap-2">
          <i class="fas fa-lock-open"></i>
          <p class="font-bold">{{ 'project.overview.header.publicProject' | translate }}</p>
        </div>
      } @else {
        <div class="flex gap-1">
          <i class="fas fa-lock"></i>
          <p class="font-bold">{{ 'project.overview.header.privateProject' | translate }}</p>
        </div>
      }
    }

    <div class="flex ml-auto">
      <div class="flex flex-1 flex-column-reverse gap-3 justify-content-end sm:gap-3 sm:flex-row-reverse lg:flex-row">
        @if (resource.storage && !isCollectionsRoute()) {
          <p class="font-bold mr-2 ml-0 mt-2 sm:ml-2 sm:mt-0 sm:align-self-center storage">
            {{ +resource.storage.storageUsage | fileSize }}
          </p>
        }

        <div class="flex gap-2 justify-content-start">
          @if (showViewOnlyLinks() && isAdmin()) {
            <p-button
              class="flex"
              [pTooltip]="'project.overview.tooltips.viewOnlyLinks' | translate"
              tooltipPosition="bottom"
              [routerLink]="'../contributors'"
              [ariaLabel]="'project.overview.tooltips.viewOnlyLinks' | translate"
            >
              <span class="font-bold">{{ resource.viewOnlyLinksCount }}</span>
              <i class="fas fa-link text-2xl"></i>
            </p-button>
          }

          @if (resource.resourceType === ResourceType.Project && !hasViewOnly()) {
            <p-button
              class="flex"
              (click)="forkActionMenu.toggle($event)"
              [pTooltip]="'project.overview.tooltips.duplicate' | translate"
              tooltipPosition="bottom"
              [ariaLabel]="'project.overview.tooltips.duplicate' | translate"
            >
              <span class="font-bold">{{ resource.forksCount }}</span>
              <i class="fas fa-clone text-2xl"></i>
              <p-menu appendTo="body" #forkActionMenu [model]="forkActionItems" popup>
                <ng-template #item let-item>
                  <a class="p-menu-item-link">
                    {{ item.label | translate }}
                  </a>
                </ng-template>
              </p-menu>
            </p-button>
          }

          @if (!hasViewOnly()) {
            <p-button
              [pTooltip]="'project.overview.tooltips.bookmarks' | translate"
              tooltipPosition="bottom"
              class="flex"
              (onClick)="toggleBookmark()"
              [loading]="isBookmarksLoading() || isBookmarksSubmitting()"
              [ariaLabel]="'project.overview.tooltips.bookmarks' | translate"
            >
              @if (!isBookmarksLoading() && !isBookmarksSubmitting()) {
                <i class="text-2xl" [ngClass]="isBookmarked() ? 'fas fa-bookmark' : 'far fa-bookmark'"></i>
              }
            </p-button>
          }

          @if (resource.isPublic && !hasViewOnly()) {
            <p-button
              class="flex"
              (onClick)="socialsActionMenu.toggle($event)"
              [pTooltip]="'project.overview.tooltips.share' | translate"
              tooltipPosition="bottom"
              [ariaLabel]="'project.overview.tooltips.share' | translate"
            >
              <span class="font-bold">{{ socialsActionItems().length }}</span>
              <i class="fas fa-share-nodes text-2xl"></i>
              <p-menu appendTo="body" #socialsActionMenu [model]="socialsActionItems()" popup>
                <ng-template #item let-item>
                  <a class="p-menu-item-link" [href]="item.url" target="_blank" rel="noopener noreferrer">
                    <div class="social-link flex align-items-center justify-content-center">
                      <osf-icon [iconClass]="`${item.icon} fa-sm`"></osf-icon>
                    </div>
                    {{ item.label | translate }}
                  </a>
                </ng-template>
              </p-menu>
            </p-button>
          }
        </div>
      </div>
    </div>
  </div>
}
