<div class="node flex flex-column p-2 pb-4 gap-4">
  <div class="flex align-items-center pt-3 pl-3 pr-3 justify-content-between">
    <h2>{{ 'project.overview.components.title' | translate }}</h2>

    @if (canEdit()) {
      <p-button
        (onClick)="handleAddComponent()"
        severity="secondary"
        [label]="'project.overview.components.addComponentButton' | translate"
      />
    }
  </div>

  <div class="node-container pl-3 pr-3 flex flex-column gap-5">
    @if (isComponentsLoading()) {
      <p-skeleton width="100%" height="7rem" />
    } @else {
      @if (components().length) {
        @for (component of components(); track component.id) {
          <div class="node-wrapper flex flex-column p-3 gap-3">
            <div class="flex justify-content-between align-items-center">
              <h2 class="flex align-items-center gap-2">
                <osf-icon [iconClass]="component.public ? 'fas fa-lock-open' : 'fas fa-lock'"></osf-icon>
                <a class="node-title" [href]="component.id">{{ component.title }}</a>
              </h2>

              @if (isCurrentUserContributor(component)) {
                <div>
                  <p-button
                    severity="contrast"
                    icon="fas fa-ellipsis-vertical"
                    raised
                    variant="outlined"
                    [ariaLabel]="'common.buttons.more' | translate"
                    (onClick)="menu.toggle($event)"
                  >
                  </p-button>

                  <p-menu appendTo="body" [model]="componentActionItems(component)" popup #menu>
                    <ng-template #item let-item>
                      <a
                        class="p-menu-item-link"
                        (mousedown)="handleMenuAction(item.action, item.componentId)"
                        (keydown.enter)="handleMenuAction(item.action, item.componentId)"
                        tabindex="0"
                      >
                        {{ item.label | translate }}
                      </a>
                    </ng-template>
                  </p-menu>
                </div>
              }
            </div>

            <div class="flex flex-wrap gap-1">
              <p class="font-bold">{{ 'common.labels.contributors' | translate }}:</p>

              <osf-contributors-list [contributors]="component.contributors"></osf-contributors-list>
            </div>

            @if (component.description) {
              <osf-truncated-text
                [text]="('resourceCard.labels.descriptionBold' | translate) + component.description"
              />
            }
          </div>
        }
      } @else {
        <div [innerHtml]="'project.overview.components.noComponentsMessage' | translate"></div>
      }
    }
  </div>
</div>
