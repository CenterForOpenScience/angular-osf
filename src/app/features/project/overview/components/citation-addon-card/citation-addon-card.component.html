<div class="citation-addon-card p-3 flex flex-column gap-3">
  <h3 class="mb-2">{{ addon().displayName }}</h3>

  <p-select
    class="w-full"
    [placeholder]="'project.overview.metadata.citationInputPlaceholder' | translate"
    [loading]="isCitationStylesLoading() || isStyleLoading()"
    [options]="citationStylesOptions()"
    [filter]="true"
    (onFilter)="handleCitationStyleFilterSearch($event)"
    optionLabel="label"
    optionValue="value"
    appendTo="body"
    [emptyFilterMessage]="filterMessage() | translate"
    [emptyMessage]="'project.overview.metadata.citationInputPlaceholder' | translate"
    (onChange)="handleCitationStyleChange($event)"
  >
    <ng-template #selectedItem let-selectedOption>
      {{ selectedOption.label }}
    </ng-template>
  </p-select>

  @if (citationItems().length && !isOperationInvocationSubmitting()) {
    <div class="citations-container flex flex-column gap-3 mt-3">
      @for (item of citationItems(); track item.itemId) {
        <osf-citation-item
          [citation]="formatCitation(item, selectedCitationStyle())"
          [itemUrl]="getItemUrl(item)"
          [level]="0"
        />
      }
      @for (collection of collectionItems(); track collection.itemId) {
        <osf-citation-collection-item
          [addon]="addon()"
          [collection]="collection"
          [level]="0"
          [selectedCitationStyle]="selectedCitationStyle()"
        />
      }
    </div>
  } @else if (!citationItems().length && isOperationInvocationSubmitting()) {
    <p-skeleton width="100%" height="6rem" />
  } @else if (!citationItems().length && !isOperationInvocationSubmitting()) {
    <!--  TODO RNa add placeholder for empty addon-->
    <p></p>
  }
</div>
